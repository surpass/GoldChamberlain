<?xml version="1.0" encoding="utf-8"?>
<chapter version="5.0" xml:lang="zh-CN" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:ns5="http://www.w3.org/2000/svg"
         xmlns:ns4="http://www.w3.org/1999/xhtml"
         xmlns:ns3="http://www.w3.org/1998/Math/MathML"
         xmlns:ns="http://docbook.org/ns/docbook">
  <title>PLT.2 Overview</title>

  <para></para>

  <section>
    <title>PLT.2.1 What is a Portal?什么是Portal</title>

    <para>A portal is a web based application that –commonly- provides
    personalization, authentication, content aggregation from different
    sources and hosts the presentation layer of information systems.
    Aggregation is the action of integrating content from different sources
    within a web page. A portal may have sophisticated personalization
    features to provide customized content to users. Portal pages may have
    different set of portlets creating content for different users.</para>
  </section>

  <section>
    <title>PLT.2.2 What is a Portlet?什么是Portlet</title>

    <para>A portlet is an application that provides a specific piece of
    content (information or service) to be included as part of a portal page.
    It is managed by a portlet container, that processes requests and
    generates dynamic content. Portlets are used by portals as pluggable user
    interface components that provide a presentation layer to information
    systems.</para>

    <para>The content generated by a portlet is also called a fragment. A
    fragment is a piece of markup (e.g. HTML, XHTML, WML) adhering to certain
    rules and can be aggregated with other fragments to form a complete
    document. The content of a portlet is normally aggregated with the content
    of other portlets to form the portal page. The lifecycle of a portlet is
    managed by the portlet container.</para>

    <para>Web clients interact with portlets via a request/response paradigm
    implemented by the portal. Normally, users interact with content produced
    by portlets, for example by following links or submitting forms, resulting
    in portlet actions being received by the portal, which are forwarded by it
    to the portlets targeted by the user's interactions.</para>

    <para>The content generated by a portlet may vary from one user to another
    depending on the user configuration for the portlet.</para>

    <para>This specification will deal with Portlets as Java technology based
    web components.</para>
  </section>

  <section>
    <title>PLT.2.3 What is a Portlet Container?什么是Portlet容器</title>

    <para>A portlet container runs portlets and provides them with the
    required runtime environment. A portlet container contains portlets and
    manages their lifecycle. It also provides persistent storage for portlet
    preferences. A portlet container receives requests from the portal to
    execute requests on the portlets hosted by it.</para>

    <para>A portlet container is not responsible for aggregating the content
    produced by the portlets. It is the responsibility of the portal to handle
    the aggregation.</para>

    <para>A portal and a portlet container can be built together as a single
    component of an application suite or as two separate components of a
    portal application.</para>
  </section>

  <section>
    <title>PLT.2.4 An Example 一个例子</title>

    <para>The following is a typical sequence of events, initiated when users
    access their portal page:</para>

    <para></para>

    <itemizedlist>
      <listitem>
        <para>A client (e.g., a web browser) after being authenticated makes
        an HTTP request to the portal</para>
      </listitem>

      <listitem>
        <para>The request is received by the portal</para>
      </listitem>

      <listitem>
        <para>The portal determines if the request contains an action targeted
        to any of the portlets associated with the portal page</para>
      </listitem>

      <listitem>
        <para>If there is an action targeted to a portlet, the portal requests
        the portlet container to invoke the portlet to process the
        action</para>
      </listitem>

      <listitem>
        <para>A portal invokes portlets, through the portlet container, to
        obtain content fragments that can be included in the resulting portal
        page</para>
      </listitem>

      <listitem>
        <para>The portal aggregates the output of the portlets in the portal
        page and sends the portal page back to the client</para>
      </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>PLT.2.5 Compatibility</title>

    <para>The Java Portlet Specification V 2.0 does not break binary
    compatibility with V 1.0. This means that all portlets written against the
    V 1.0 specification can run unchanged. Portlet V2.0 containers must
    support deploying JSR 168 portlets and the JSR 168 deployment 25
    descriptor.</para>

    <para>The only exceptions to this rule are:</para>

    <itemizedlist>
      <listitem>
        <para>RenderResponse.setContentType is no longer required before
        calling getWriter or getOutputstream. Calling getWriter or
        getOutputstream without previously setting the content type results no
        longer in an IllegalStateException in V 2.0.</para>
      </listitem>

      <listitem>
        <para>getProtocol for included servlets / JSPs no longer returns null,
        but ‘HTTP/1.1’ in V2.0.</para>
      </listitem>
    </itemizedlist>
  </section>

  <section>
    <title>PLT.2.6 Major changes introduced with V 2.0</title>

    <para>The major new features of version 2.0 include:</para>

    <para></para>

    <itemizedlist>
      <listitem>
        <para>Events – enabling a portlet to send and receive events and
        perform state changes or send further events as a result of processing
        an event.</para>
      </listitem>

      <listitem>
        <para>Public render parameters – allowing portlets to share parameters
        with other portlets.</para>
      </listitem>

      <listitem>
        <para>Resource serving – provides the ability for a portlet to serve a
        resource.</para>
      </listitem>

      <listitem>
        <para>Portlet filter – allowing on-the-fly transformations of
        information in both the request to and the response from a
        portlet.</para>
      </listitem>
    </itemizedlist>

    <section>
      <title>PLT.2.6.1 Clarifications that may make V1.0 Portlets
      Non-compliant</title>

      <para>Depending on the implementation of the portlet of a specific
      runtime behavior of a portlet container the following clarifications may
      lead to different results when executing a portlet in either a JSR 168
      or a JSR 286 container:</para>

      <para></para>

      <itemizedlist>
        <listitem>
          <para>XML escaping of portlet URLs produced via the portlet tag
          library. V 2.0 clarifies that the default is all portlet URLs are
          XML escaped. The default can be changed with the new attribute
          escapeXML. JSR 168 portlets depending on the fact that portlet URLs
          created via the tag library are not XML escaped can change the
          default to non-escaped via the portlet container runtime option
          javax.portlet.escapeXml (see PLT.26.7)</para>
        </listitem>

        <listitem>
          <para>Defining multiple values for the same parameter name in the
          Portlet param tag. V 2.0 clarifies that if the same name of a
          parameter occurs more than once within an actionURL, renderURL or
          resourceURL the values must be delivered as parameter value array
          with the values in the order of the declaration within the URL tag.
          Portlets assuming that the last occurrence wins and replaces the
          previous set values will behave differently in V2.0
          containers.</para>
        </listitem>

        <listitem>
          <para>getProtocol for included servlets / JSPs no longer returns
          null. V 2.0 defines that getProtocol now returns ‘HTTP/1.1’ and thus
          is better aligned with the servlet model that expects the
          getProtocol to return this value in the GenericServlet.</para>
        </listitem>

        <listitem>
          <para>Parameters set on the portlet URL and the post body are
          aggregated into the request parameter set. Portlet URL parameters
          are presented before post body data. JSR 168 did not define if and
          how post body and portlet URL parameters are being merged. The added
          clarification mirrors the behavior defined in the servlet
          specification for servlets.</para>
        </listitem>

        <listitem>
          <para>RenderResponse.setContentType is no longer required before
          calling getWriter or getOutputstream. Calling getWriter or
          getOutputstream without previously setting the content type will no
          longer result in an IllegalStateException.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>PLT.2.6.2 Changes to the Programming Model</title>

      <para>The following additions were made to the V1.0 programming
      model:</para>

      <itemizedlist>
        <listitem>
          <para>Use application level resource bundles instead of inline
          localization in the portlet.xml.</para>

          <para>In V1.0 the only ability to localize values on the portlet
          application level was inside the portlet.xml using the xml:lang
          attribute. With V2.0 portlet application developers can now provide
          the localized values in a resource bundle and thus have the
          localized values in separate files instead of cluttering the
          deployment descriptor.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section>
      <title>PLT.2.6.3 List of all Changes in the Specification</title>

      <para>This section list all changes that are not editorial in
      nature:</para>

      <itemizedlist>
        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>

        <listitem>
          <para>s</para>
        </listitem>
      </itemizedlist>

      <para></para>

      <para>s</para>
    </section>

    <section>
      <title>PLT.2.6.3 List of all Changes in the Specification</title>

      <para>This section list all non-editorial API changes:</para>

      <para></para>

      <itemizedlist>
        <listitem>
          <para>ActionRequest:</para>

          <itemizedlist>
            <listitem>
              <para>extends ClientDataRequest</para>
            </listitem>

            <listitem>
              <para>added ACTION_NAME constant</para>
            </listitem>

            <listitem>
              <para>added getMethod</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>ActionResponse:</para>
        </listitem>

        <listitem>
          <para>added new BaseURL interface</para>
        </listitem>

        <listitem>
          <para>added new CacheControl interface</para>
        </listitem>

        <listitem>
          <para>added new Event interface</para>
        </listitem>

        <listitem>
          <para>added new EventInterface interface</para>
        </listitem>

        <listitem>
          <para>added new Event</para>
        </listitem>

        <listitem>
          <para>GenericPortlet</para>

          <itemizedlist>
            <listitem>
              <para>implements ResourceServingPortlet, EventPortlet</para>
            </listitem>

            <listitem>
              <para>added new PortletConfig methods</para>
            </listitem>

            <listitem>
              <para>added doHeaders method</para>
            </listitem>

            <listitem>
              <para>added getNextPossiblePortletModes method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>added new MimeResponse interface</para>
        </listitem>

        <listitem>
          <para>PortalContext</para>

          <itemizedlist>
            <listitem>
              <para>added constant MARKUP_HEAD_ELEMENT_SUPPORT</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletConfig</para>

          <itemizedlist>
            <listitem>
              <para>added getPublicRenderParameterNames method</para>
            </listitem>

            <listitem>
              <para>added getDefaultNamespace method</para>
            </listitem>

            <listitem>
              <para>added getPublishingEventQNames method</para>
            </listitem>

            <listitem>
              <para>added getProcessingEventQNames method</para>
            </listitem>

            <listitem>
              <para>added getSupportedLocales method</para>
            </listitem>

            <listitem>
              <para>added getContainerRuntimeOptions method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletContext</para>

          <itemizedlist>
            <listitem>
              <para>added getContainerRuntimeOptions method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletRequest</para>

          <itemizedlist>
            <listitem>
              <para>added constants CCPP_PROFILE, ACTION_PHASE, EVENT_PHASE,
              RENDER_PHASE, RESOURCE_PHASE, LIFECYCLE_PHASE, RENDER_PART,
              RENDER_HEADERS, RENDER_MARKUP, ACTION_SCOPE_ID</para>
            </listitem>

            <listitem>
              <para>added enum P3PUserInfos</para>
            </listitem>

            <listitem>
              <para>added getWindowID method</para>
            </listitem>

            <listitem>
              <para>added getCookies method</para>
            </listitem>

            <listitem>
              <para>added getPrivateParameterMap method</para>
            </listitem>

            <listitem>
              <para>added getPublicParameterMap method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletRequestDispatcher</para>

          <itemizedlist>
            <listitem>
              <para>added include(PortletRequest request, PortletResponse
              response) method</para>
            </listitem>

            <listitem>
              <para>added forward method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletResponse</para>

          <itemizedlist>
            <listitem>
              <para>changed getNamespace: lifetime is now for the portlet
              window instead just request</para>
            </listitem>

            <listitem>
              <para>added addProperty(javax.servlet.http.Cookie cookie)
              method</para>
            </listitem>

            <listitem>
              <para>added addProperty(String key, org.w3c.dom.Element element)
              method</para>
            </listitem>

            <listitem>
              <para>added createElement method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>PortletSession</para>
        </listitem>

        <listitem>
          <para>PortletURL</para>

          <itemizedlist>
            <listitem>
              <para>extends BaseURL</para>
            </listitem>

            <listitem>
              <para>added add/setProperty methods</para>
            </listitem>

            <listitem>
              <para>added getParameterMap</para>
            </listitem>

            <listitem>
              <para>added writer methods</para>
            </listitem>

            <listitem>
              <para>added getPortletMode method</para>
            </listitem>

            <listitem>
              <para>added getWindowState</para>
            </listitem>

            <listitem>
              <para>added removePublicRenderParameter method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>added PortletURLGenerationListener interface</para>
        </listitem>

        <listitem>
          <para>added ProcessAction annotation</para>
        </listitem>

        <listitem>
          <para>added ProcessEvent annotation</para>
        </listitem>

        <listitem>
          <para>added RenderMode annotation</para>
        </listitem>

        <listitem>
          <para>RenderRequest</para>

          <itemizedlist>
            <listitem>
              <para>added constant ETAG</para>
            </listitem>

            <listitem>
              <para>added getETag method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>RenderResponse</para>

          <itemizedlist>
            <listitem>
              <para>extends MimeResponse</para>
            </listitem>

            <listitem>
              <para>added constants CACHE_SCOPE, PUBLIC_SCOPE, PRIVATE_SCOPE,
              ETAG, USE_CACHED_CONTENT, NAMESPACED_RESPONSE,
              MARKUP_HEAD_ELEMENT,</para>
            </listitem>

            <listitem>
              <para>added createResourceURL method</para>
            </listitem>

            <listitem>
              <para>added getCacheControl method</para>
            </listitem>

            <listitem>
              <para>added setNextPossiblePortletModes method</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>added ResourceRequest interface</para>
        </listitem>

        <listitem>
          <para>added ResourceResponse interface</para>
        </listitem>

        <listitem>
          <para>added ResourceServingPortlet interface</para>
        </listitem>

        <listitem>
          <para>added ResourceURL interface</para>
        </listitem>

        <listitem>
          <para>added StateAwareResponse interface</para>
        </listitem>

        <listitem>
          <para>added javax.portlet.filter package</para>

          <itemizedlist>
            <listitem>
              <para>added ActionFilter interface</para>
            </listitem>

            <listitem>
              <para>added ActionRequestWrapper class</para>
            </listitem>

            <listitem>
              <para>added ActionResponseWrapper class</para>
            </listitem>

            <listitem>
              <para>added EventFilter interface</para>
            </listitem>

            <listitem>
              <para>added EventRequestWrapper class</para>
            </listitem>

            <listitem>
              <para>added EventResponseWrapper class</para>
            </listitem>

            <listitem>
              <para>added FilterConfig interface</para>
            </listitem>

            <listitem>
              <para>added FilterChain interface</para>
            </listitem>

            <listitem>
              <para>added PortletFilter interface</para>
            </listitem>

            <listitem>
              <para>added PortletRequestWrapper class</para>
            </listitem>

            <listitem>
              <para>added PortletResponseWrapper class</para>
            </listitem>

            <listitem>
              <para>added RenderFilter interface</para>
            </listitem>

            <listitem>
              <para>added RenderRequestWrapper class</para>
            </listitem>

            <listitem>
              <para>added RenderResponseWrapper class</para>
            </listitem>

            <listitem>
              <para>added ResourceFilter interface</para>
            </listitem>

            <listitem>
              <para>added ResourceRequestWrapper class</para>
            </listitem>

            <listitem>
              <para>added ResourceResponseWrapper class</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>
  </section>

  <section>
    <title>PLT.2.7 Relationship with Java 2 Platform, Standard and Enterprise
    Edition</title>

    <para>。。。</para>
  </section>
</chapter>
